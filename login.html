<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login — Jejak Belajar</title>

  <!-- Bootstrap 5 CSS (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Supabase JS (CDN) -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    body {
      background: linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    .card-login {
      max-width: 420px;
      width: 100%;
      border: 0;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(35, 50, 80, 0.08);
    }
    .brand {
      width: 48px;
      height: 48px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: linear-gradient(135deg,#20c997,#198754);
      color: white;
      font-weight: 700;
      font-size: 20px;
      margin-right: .5rem;
    }
    .form-footer {
      font-size: .9rem;
    }
  </style>
</head>
<body>
  <main class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-md-9 col-lg-6">

        <div class="card card-login p-4">
          <div class="card-body">
            <div class="text-center mb-4">
              <span class="brand">JB</span>
              <h5 class="d-inline align-middle mb-0">Jejak Belajar</h5>
              <p class="text-muted mb-0">Masuk untuk mengelola konten dan pembelajaran</p>
            </div>

            <!-- Login form -->
            <form id="loginForm" class="needs-validation" novalidate>
              <div class="mb-3">
                <label for="inputEmail" class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  id="inputEmail"
                  name="email"
                  placeholder="nama@domain.com"
                  required
                  autocomplete="username"
                >
                <div class="invalid-feedback">Mohon masukkan email yang valid.</div>
              </div>

              <div class="mb-3 position-relative">
                <label for="inputPassword" class="form-label">Kata Sandi</label>
                <div class="input-group">
                  <input
                    type="password"
                    class="form-control"
                    id="inputPassword"
                    name="password"
                    placeholder="Masukkan kata sandi"
                    required
                    autocomplete="current-password"
                  >
                  <button class="btn btn-outline-secondary" type="button" id="togglePassword" aria-label="Tampilkan kata sandi">
                    <svg id="eyeOpen" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                      <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8z"/>
                      <path d="M8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                    </svg>
                    <svg id="eyeClosed" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash d-none" viewBox="0 0 16 16">
                      <path d="M13.359 11.238C12.11 12.248 10.624 13 8 13c-3 0-5.045-1.224-6.6-2.545a.5.5 0 1 1 .7-.714C4.336 11.21 6.254 12 8 12c2.083 0 3.5-.622 4.333-1.238a.5.5 0 1 1 .707.476z"/>
                      <path d="M2.354 1.646a.5.5 0 1 0-.708.708l1.454 1.454C1.39 5.39.1 6.81 0 8c0 0 3 5.5 8 5.5 1.35 0 2.614-.3 3.688-.833l1.56 1.56a.5.5 0 0 0 .708-.708L2.354 1.646z"/>
                    </svg>
                  </button>
                </div>
                <div class="invalid-feedback">Masukkan kata sandi.</div>
              </div>

              <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" id="rememberMe" name="remember">
                  <label class="form-check-label" for="rememberMe">Ingat saya</label>
                </div>
                <a href="#" class="small">Lupa kata sandi?</a>
              </div>

              <div class="d-grid mb-3">
                <button type="submit" class="btn btn-success btn-lg">Masuk</button>
              </div>

              <div id="loginMessage" class="text-center small"></div>

              <div class="text-center form-footer mt-3">
                Belum punya akun? <a href="#">Daftar di sini</a>
              </div>
            </form>
          </div>
        </div>

        <p class="text-center text-muted mt-3 small">Hak cipta &copy; Jejak Belajar — 2025</p>
      </div>
    </div>
  </main>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Konfigurasi Supabase
    const SUPABASE_URL = "https://vnyljyshijbwuvpmcvbd.supabase.co"; // Ganti dengan Project URL
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueWxqeXNoaWpid3V2cG1jdmJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyODczMjQsImV4cCI6MjA3NDg2MzMyNH0.8OY69qUkU3xDrPC78rpPabu4-haTfLLGUnCKSCRoKBc"; // Ganti dengan Anon Key
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Toggle password
    (function () {
      const toggle = document.getElementById('togglePassword');
      const pwd = document.getElementById('inputPassword');
      const eyeOpen = document.getElementById('eyeOpen');
      const eyeClosed = document.getElementById('eyeClosed');

      toggle.addEventListener('click', function () {
        const type = pwd.getAttribute('type') === 'password' ? 'text' : 'password';
        pwd.setAttribute('type', type);
        eyeOpen.classList.toggle('d-none');
        eyeClosed.classList.toggle('d-none');
      });
    })();

    // Form login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('inputEmail').value;
      const password = document.getElementById('inputPassword').value;
      const msg = document.getElementById('loginMessage');

      msg.innerHTML = "Sedang memproses...";

      const { data, error } = await supabase.auth.signInWithPassword({
        email: email,
        password: password
      });

      if (error) {
        msg.innerHTML = `<span class="text-danger">❌ Login gagal: ${error.message}</span>`;
      } else {
        msg.innerHTML = `<span class="text-success">✅ Selamat datang ${data.user.email}</span>`;
      }
    });
  </script>
</body>
</html>
